<UserControl x:Class="AlhimikGame.WPF.Views.GameLevelsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:viewModels="clr-namespace:AlhimikGame.WPF.ViewModels"
             xmlns:models="clr-namespace:AlhimikGame.Core.Models"
             mc:Ignorable="d"
             d:DesignHeight="1000" d:DesignWidth="1000">
    <UserControl.Resources>
        <!-- Color Palette Based on Screenshot -->
        <Color x:Key="DarkBackgroundColor">#1C1B24</Color>
        <Color x:Key="MediumBackgroundColor">#262337</Color>
        <Color x:Key="LightPurpleColor">#9D71EA</Color>
        <Color x:Key="BrightPurpleColor">#8157D2</Color>
        <Color x:Key="HoverPurpleColor">#A47FF0</Color>
        <Color x:Key="DarkPurpleColor">#6B46B8</Color>
        <Color x:Key="TextColor">#FFFFFF</Color>
        <Color x:Key="SecondaryTextColor">#B0A8D0</Color>
        
        <!-- Brushes -->
        <SolidColorBrush x:Key="DarkBackgroundBrush" Color="{StaticResource DarkBackgroundColor}"/>
        <SolidColorBrush x:Key="MediumBackgroundBrush" Color="{StaticResource MediumBackgroundColor}"/>
        <SolidColorBrush x:Key="LightPurpleBrush" Color="{StaticResource LightPurpleColor}"/>
        <SolidColorBrush x:Key="BrightPurpleBrush" Color="{StaticResource BrightPurpleColor}"/>
        <SolidColorBrush x:Key="HoverPurpleBrush" Color="{StaticResource HoverPurpleColor}"/>
        <SolidColorBrush x:Key="DarkPurpleBrush" Color="{StaticResource DarkPurpleColor}"/>
        <SolidColorBrush x:Key="TextBrush" Color="{StaticResource TextColor}"/>
        <SolidColorBrush x:Key="SecondaryTextBrush" Color="{StaticResource SecondaryTextColor}"/>

        <!-- Modern Dark ListBox Style -->
        <Style x:Key="DarkModernListBox" TargetType="ListBox">
            <Setter Property="Background" Value="{StaticResource MediumBackgroundBrush}"/>
            <Setter Property="BorderBrush" Value="{StaticResource DarkPurpleBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="10"/>
            <Setter Property="Foreground" Value="{StaticResource TextBrush}"/>
            <Setter Property="ItemContainerStyle">
                <Setter.Value>
                    <Style TargetType="ListBoxItem">
                        <Setter Property="Margin" Value="0,3"/>
                        <Setter Property="Padding" Value="8"/>
                        <Setter Property="Background" Value="{StaticResource DarkBackgroundBrush}"/>
                        <Setter Property="BorderBrush" Value="{StaticResource DarkPurpleBrush}"/>
                        <Setter Property="BorderThickness" Value="1"/>
                        <Setter Property="Foreground" Value="{StaticResource TextBrush}"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="ListBoxItem">
                                    <Border Background="{TemplateBinding Background}"
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            BorderThickness="{TemplateBinding BorderThickness}"
                                            CornerRadius="4"
                                            Padding="{TemplateBinding Padding}">
                                        <ContentPresenter/>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="{StaticResource MediumBackgroundBrush}"/>
                                            <Setter Property="BorderBrush" Value="{StaticResource LightPurpleBrush}"/>
                                        </Trigger>
                                        <Trigger Property="IsSelected" Value="True">
                                            <Setter Property="Background" Value="{StaticResource DarkPurpleBrush}"/>
                                            <Setter Property="BorderBrush" Value="{StaticResource LightPurpleBrush}"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                    </Style>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Purple Button Style -->
        <Style x:Key="PurpleButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource BrightPurpleBrush}"/>
            <Setter Property="Foreground" Value="{StaticResource TextBrush}"/>
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="Margin" Value="0,2"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}"
                                CornerRadius="4"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{StaticResource HoverPurpleBrush}"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="{StaticResource DarkPurpleBrush}"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Section Header Style -->
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="0,10,0,10"/>
            <Setter Property="Foreground" Value="{StaticResource LightPurpleBrush}"/>
        </Style>
    </UserControl.Resources>
    
    <Grid Background="{StaticResource DarkBackgroundBrush}">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="250"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Levels List -->
        <Border Grid.Column="0" 
                Background="{StaticResource MediumBackgroundBrush}"
                CornerRadius="8" 
                Margin="10">
            <ListBox ItemsSource="{Binding Levels}"
                     SelectedItem="{Binding SelectedLevel}"
                     Margin="5"
                     Style="{StaticResource DarkModernListBox}"
                     Background="Transparent"
                     BorderThickness="0">
                <ListBox.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="{Binding Name}" 
                                       Foreground="{Binding IsCompleted, Converter={StaticResource CompletedLevelColorConverter}}"
                                       FontWeight="Medium"/>
                            <TextBlock Text=" (Completed)" 
                                       Visibility="{Binding IsCompleted, Converter={StaticResource BoolToVisibilityConverter}}"
                                       Margin="5,0,0,0"
                                       Foreground="{StaticResource LightPurpleBrush}"
                                       FontStyle="Italic"/>
                        </StackPanel>
                    </DataTemplate>
                </ListBox.ItemTemplate>
            </ListBox>
        </Border>

        <!-- Level Details -->
        <Border Grid.Column="1" 
                Background="{StaticResource MediumBackgroundBrush}"
                CornerRadius="8" 
                Margin="10">
            <Grid Margin="15">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Selected Level Details -->
                <StackPanel Grid.Row="0" 
                            Visibility="{Binding SelectedLevel, Converter={StaticResource NullToVisibilityConverter}}">
                    <TextBlock Text="{Binding SelectedLevel.Name}" 
                               Style="{StaticResource SectionHeaderStyle}"
                               FontSize="22"/>
                    
                    <TextBlock Text="Необхідні еліксири:" 
                               FontWeight="SemiBold"
                               Margin="0,15,0,8"
                               Foreground="{StaticResource SecondaryTextBrush}"/>
                    <ListBox ItemsSource="{Binding SelectedLevel.RequiredElixirs}"
                             MaxHeight="120"
                             Style="{StaticResource DarkModernListBox}"
                             Background="Transparent"
                             BorderThickness="0">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding Name}" Margin="0,0,10,0" Foreground="{StaticResource TextBrush}"/>
                                    <TextBlock Text="{Binding Type}" 
                                               Foreground="{StaticResource SecondaryTextBrush}"
                                               FontStyle="Italic"/>
                                </StackPanel>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </StackPanel>

                <!-- Character Details -->
                <Grid Grid.Row="1" 
                      Margin="0,20,0,0"
                      Visibility="{Binding CurrentCharacter, Converter={StaticResource NullToVisibilityConverter}}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <!-- Character Image -->
                    <Border Grid.Column="0" 
                            Width="150" 
                            Height="200" 
                            BorderBrush="{StaticResource LightPurpleBrush}" 
                            BorderThickness="2" 
                            Margin="0,0,20,0"
                            CornerRadius="8"
                            Background="{StaticResource DarkBackgroundBrush}">
                        <Image Source="{Binding CurrentCharacter.CharacterImage}" 
                               Stretch="Uniform" 
                               Margin="5"/>
                    </Border>
                    
                    <!-- Character Stats -->
                    <Border Grid.Column="1"
                            Background="{StaticResource DarkBackgroundBrush}"
                            BorderBrush="{StaticResource DarkPurpleBrush}"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="15">
                        <StackPanel>
                            <TextBlock Text="Деталі персонажа" 
                                       Style="{StaticResource SectionHeaderStyle}"/>
                            <TextBlock Text="{Binding CurrentCharacter.Name}"
                                       FontSize="16"
                                       FontWeight="Medium"
                                       Margin="0,5,0,15"
                                       Foreground="{StaticResource TextBrush}"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <TextBlock Grid.Row="0" Grid.Column="0" Text="Здоров'я:" FontWeight="SemiBold" Margin="0,4,10,4" Foreground="{StaticResource SecondaryTextBrush}"/>
                                <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding CurrentCharacter.Health}" Foreground="{StaticResource TextBrush}"/>
                                
                                <TextBlock Grid.Row="1" Grid.Column="0" Text="Мана:" FontWeight="SemiBold" Margin="0,4,10,4" Foreground="{StaticResource SecondaryTextBrush}"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding CurrentCharacter.Mana}" Foreground="{StaticResource TextBrush}"/>
                                
                                <TextBlock Grid.Row="2" Grid.Column="0" Text="Сила:" FontWeight="SemiBold" Margin="0,4,10,4" Foreground="{StaticResource SecondaryTextBrush}"/>
                                <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding CurrentCharacter.Strength}" Foreground="{StaticResource TextBrush}"/>
                                
                                <TextBlock Grid.Row="3" Grid.Column="0" Text="Розум:" FontWeight="SemiBold" Margin="0,4,10,4" Foreground="{StaticResource SecondaryTextBrush}"/>
                                <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding CurrentCharacter.Intelligence}" Foreground="{StaticResource TextBrush}"/>
                                
                                <TextBlock Grid.Row="4" Grid.Column="0" Text="Захист:" FontWeight="SemiBold" Margin="0,4,10,4" Foreground="{StaticResource SecondaryTextBrush}"/>
                                <TextBlock Grid.Row="4" Grid.Column="1" Text="{Binding CurrentCharacter.Defense}" Foreground="{StaticResource TextBrush}"/>
                                
                                <TextBlock Grid.Row="5" Grid.Column="0" Text="Поточний розмір:" FontWeight="SemiBold" Margin="0,4,10,4" Foreground="{StaticResource SecondaryTextBrush}"/>
                                <TextBlock Grid.Row="5" Grid.Column="1" Text="{Binding CurrentCharacter.Size}" Foreground="{StaticResource TextBrush}"/>
                            </Grid>
                        </StackPanel>
                    </Border>
                </Grid>

                <!-- Elixirs -->
                <StackPanel Grid.Row="2" Margin="0,20,0,0">
                    <TextBlock Text="Доступні еліксири" 
                               Style="{StaticResource SectionHeaderStyle}"/>
                    <Border Background="{StaticResource DarkBackgroundBrush}"
                            BorderBrush="{StaticResource DarkPurpleBrush}"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="10">
                        <ListBox ItemsSource="{Binding AvailableElixirs}"
                                 MaxHeight="180"
                                 Style="{StaticResource DarkModernListBox}"
                                 Background="Transparent"
                                 BorderThickness="0">
                            <ListBox.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <WrapPanel Orientation="Horizontal" />
                                </ItemsPanelTemplate>
                            </ListBox.ItemsPanel>
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Width="250" Margin="5">
                                        <Button Content="{Binding Name}"
                                                Style="{StaticResource PurpleButton}"
                                                Command="{Binding DataContext.UseElixirCommand, 
                                                         RelativeSource={RelativeSource AncestorType={x:Type UserControl}}}"
                                                CommandParameter="{Binding}"
                                                Width="180">
                                            <Button.ToolTip>
                                                <StackPanel>
                                                    <TextBlock Text="{Binding Name}" FontWeight="Bold"/>
                                                    <TextBlock Text="{Binding Type}" 
                                                               Foreground="#B0A8D0"
                                                               FontStyle="Italic"/>
                                                </StackPanel>
                                            </Button.ToolTip>
                                        </Button>
                                        <TextBlock Text="{Binding Type}" 
                                                   Foreground="{StaticResource SecondaryTextBrush}"
                                                   FontStyle="Italic"
                                                   HorizontalAlignment="Center"
                                                   Margin="0,4,0,0"/>
                                    </StackPanel>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </Border>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</UserControl>